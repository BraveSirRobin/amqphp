<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title>Amqphp persistent connection testbed.</title>
    <style type="text/css">
      .layout-table {
        border: 1px solid black;
        width: 100%;
      }
      .layout-table td {
        vertical-align: top;
        padding: 0.25em;
      }
      .bigger {
        font-size: 2em;
      }
      label {
        display: block;
        clear: both;
      }
      .sent .send .received .receive {
        vertical-align: top;
      }
      .point {
        clear: right;
      }
    </style>
  </head>
  <body>
    <h1>Experiment with Amqphp persistent connections!</h1>

    <?php if ($this->messages) { ?><!-- Begin messages -->
    <div id="messages">
      <ul>
        <?php foreach ($this->messages as $i => $m) { ?>
          <li><?php echo $m ?></li>
        <?php } ?>
      </ul>
    </div>
    <?php } ?><!-- End messages -->



    <h2>Connection Data</h2>
    <div id="conn-data">
      <span class="point">PHP process ID: <strong><?php echo getmypid(); ?></strong></span>


      <?php foreach ($this->demo->getConnections() as $conn) { ?>
      <div class="conn-info">
        <h3>Connection <?php echo $conn->getSocketCK() ?></h3>
        <span class="point">Amqp VHost: <strong><?php $conn->getVHost() ?></strong></span>
      </div>
      <?php } ?>
    </div>



    <table id="read-layout" class="layout-table">
      <tbody>
        <tr>
          <td>
            <div id="received">
              <h3>Received</h3>
              <table class="listing">
                <thead>
                </thead>
                <tbody>
                </tbody>
              </table>
            </div>
          </td>
          <td>
            <div id="sent">
              <h3>Sent</h3>
              <table class="listing">
                <thead>
                </thead>
                <tbody>
                </tbody>
              </table>
            </div>
          </td>
        </tr>
      </tbody>
    </table>


    <form method="GET" id="controls" class="layout-table">
      <span class="left">
        <label for="action-send">Send Messages <input type="checkbox" name="action[tasks][]" value="send" id="action-send"/></label>
        <label for="action-receive">Receive Messages <input type="checkbox" name="action[tasks][]" value="receive" id="action-receive"/></label>
      </span>

      <span class="right">
        <label for="action-sendfirst">Process sends first <input type="radio" name="action[web-req-seq]" value="send_first" checked="checked"/></label>
        <label for="action-receivefirst">Process receives first <input type="radio" name="action[web-req-seq]" value="receive_first" checked="checked"/></label>
      </span>
      <input type="submit" value="Go.."/>

      <hr/>
      <table id="write-layout">
        <tbody>
          <tr>
            <td>
              <div id="send">
                <h3>Send Messages</h3>
                <span class="bigger">Repeat this sequence of messages <input type="send[ntimes]" value="1"/> time(s)</span>
                <hr/>
                <textarea id="new-msg-1" name="send[messages][]"></textarea>
                <button id="new-msg-btn">Another</button>
              </div>
            </td>
            <td>
              <div id="receive">
                <h3>Receive messages</h3>
                <label for="select-relative">SELECT_TIMEOUT_REL <input id="select-relative" type="radio" name="read[select-mode]" value="relative" checked="checked"/></label>
                <label for="select-maxloops">SELECT_MAXLOOPS <input id="select-maxloops" type="radio" name="read[select-mode]" value="maxloops"/></label>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </form>
    
  </body>
</html>
